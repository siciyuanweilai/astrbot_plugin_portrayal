{
    "llm": {
        "description": "LLM配置",
        "type": "object",
        "items": {
            "provider_id": {
                "description": "用于分析画像的LLM提供商",
                "hint": "留空或者填写的提供商不存在时, 则使用当前正在使用的LLM提供商",
                "type": "string",
                "default": "",
                "_special": "select_provider"
            },
            "retry_times": {
                "description": "LLM调用失败重试次数",
                "type": "int",
                "hint": "LLM调用失败时, 重试的次数",
                "slider": {
                    "min": 1,
                    "max": 5,
                    "step": 1
                },
                "default": 2
            }
        }
    },
    "message": {
        "description": "消息查询配置",
        "type": "object",
        "items": {
            "default_query_rounds": {
                "description": "获取群消息的默认轮询次数",
                "type": "int",
                "hint": "每轮固定获取消息(通常20-100条), 此处指定轮询多少次。也可用命令 “画像 @群友 轮数” 可实时指定轮数",
                "slider": {
                    "min": 1,
                    "max": 80,
                    "step": 10
                },
                "default": 30
            },
            "max_msg_count": {
                "description": "用于分析的最大对话片段数",
                "type": "int",
                "hint": "轮询过程中，提取到的有效对话片段数达到此值时停止。注意：包含上下文会消耗更多Token",
                "slider": {
                    "min": 10,
                    "max": 1000,
                    "step": 10
                },
                "default": 500
            },
            "context_num": {
                "description": "上下文回溯数量",
                "type": "int",
                "hint": "分析某条消息时，同时获取它前面几条消息作为背景。建议1-3条，多了容易Token溢出。",
                "slider": {
                    "min": 0,
                    "max": 5,
                    "step": 1
                },
                "default": 2
            },
            "cache_ttl_min": {
                "description": "消息缓存的过期时长(分钟)",
                "type": "int",
                "hint": "注意：开启上下文分析后，缓存机制已调整为实时拉取为主，此选项可能仅用于部分逻辑",
                "slider": {
                    "min": 1,
                    "max": 60,
                    "step": 1
                },
                "default": 30
            },
            "analysis_cooldown": {
                "description": "画像分析冷却时间(天)",
                "type": "float",
                "hint": "同一个群友在指定天数内只能被分析一次。0则不限制。支持小数，如0.5代表半天。",
                "default": 0,
                "slider": { 
                    "min": 0, 
                    "max": 30, 
                    "step": 0.1 
                }
            },
            "allow_analyze_self": {
                "description": "允许分析Bot自身",
                "type": "bool",
                "hint": "开启后，若使用“画像 @Bot”，将分析Bot自己的历史发言。",
                "default": false
            }
        }
    },
    "load_builtin_prompt": {
        "description": "加载内置提示词条目",
        "type": "bool",
        "hint": "是否加载插件内置的提示词条目，文件位置: data/plugins/astrbot_plugin_portrayal/default_prompt.yaml",
        "default": true
    },
    "entry_storage": {
        "description": "提示词配置",
        "hint": "可自定义多套提示词，并定义对应触发命令。由此实现不同风格的画像分析",
        "type": "template_list",
        "templates": {
            "default": {
                "name": "提示词条目",
                "items": {
                    "command": {
                        "description": "触发命令",
                        "hint": "定义用什么命令触发本套提示词",
                        "type": "string",
                        "default": "请输入命令"
                    },
                    "content": {
                        "description": "提示词内容",
                        "hint": "请填写提示词内容",
                        "type": "text",
                        "default": "请输入提示词"
                    }
                }
            }
        }
    }
}